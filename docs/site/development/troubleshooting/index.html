<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Troubleshooting - NioChat</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/rainbow.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">NioChat</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">NioChat - Sistema de Atendimento WhatsApp</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../changelog/" class="nav-link">Changelog</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Ai</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../ai/configuration/" class="dropdown-item">Configuração da IA</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Api</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../api/authentication/" class="dropdown-item">Autenticação</a>
</li>
                                    
<li>
    <a href="../../api/endpoints/" class="dropdown-item">Endpoints da API</a>
</li>
                                    
<li>
    <a href="../../api/postman-guide/" class="dropdown-item">Guia de Uso do Postman com NioChat</a>
</li>
                                    
<li>
    <a href="../../api/webhooks/" class="dropdown-item">Webhooks</a>
</li>
                                    
<li>
    <a href="../../api/websocket/" class="dropdown-item">WebSocket</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Configuration</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../configuration/supabase/" class="dropdown-item">Configuração do Supabase</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Development</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../contributing/" class="dropdown-item">Contribuindo para o NioChat</a>
</li>
                                    
<li>
    <a href="../structure/" class="dropdown-item">Estrutura do Projeto</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Troubleshooting</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Installation</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../installation/development/" class="dropdown-item">Instalação em Desenvolvimento</a>
</li>
                                    
<li>
    <a href="../../installation/production/" class="dropdown-item">Instalação em Produção</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Overview</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../overview/architecture/" class="dropdown-item">Arquitetura do Sistema</a>
</li>
                                    
<li>
    <a href="../../overview/features/" class="dropdown-item">Funcionalidades</a>
</li>
                                    
<li>
    <a href="../../overview/introduction/" class="dropdown-item">Introdução ao NioChat</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Supabase</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../supabase/integration/" class="dropdown-item">Integração com Supabase</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Usage</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../usage/interface/" class="dropdown-item">Interface do Usuário</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../structure/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../installation/development/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#troubleshooting" class="nav-link">Troubleshooting</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-instalacao" class="nav-link">Problemas de Instalação</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-backend" class="nav-link">Problemas de Backend</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-frontend" class="nav-link">Problemas de Frontend</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-api" class="nav-link">Problemas de API</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-websocket" class="nav-link">Problemas de WebSocket</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-integracao" class="nav-link">Problemas de Integração</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-performance" class="nav-link">Problemas de Performance</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-logs" class="nav-link">Problemas de Logs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-seguranca" class="nav-link">Problemas de Segurança</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#problemas-de-deploy" class="nav-link">Problemas de Deploy</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#comandos-uteis" class="nav-link">Comandos Úteis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#logs-importantes" class="nav-link">Logs Importantes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#contato" class="nav-link">Contato</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#proximos-passos" class="nav-link">Próximos Passos</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="troubleshooting">Troubleshooting</h1>
<p>Este guia ajuda a resolver problemas comuns no NioChat.</p>
<h2 id="problemas-de-instalacao">Problemas de Instalação</h2>
<h3 id="python-nao-encontrado">Python não encontrado</h3>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt install python3 python3-pip python3-venv

# CentOS/RHEL
sudo yum install python3 python3-pip
</code></pre>
<h3 id="nodejs-nao-encontrado">Node.js não encontrado</h3>
<pre><code class="language-bash"># Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_16.x | sudo bash -
sudo yum install nodejs
</code></pre>
<h3 id="postgresql-nao-encontrado">PostgreSQL não encontrado</h3>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt install postgresql postgresql-contrib

# CentOS/RHEL
sudo yum install postgresql postgresql-server
sudo postgresql-setup initdb
sudo systemctl enable postgresql
sudo systemctl start postgresql
</code></pre>
<h3 id="redis-nao-encontrado">Redis não encontrado</h3>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt install redis-server

# CentOS/RHEL
sudo yum install redis
sudo systemctl enable redis
sudo systemctl start redis
</code></pre>
<h2 id="problemas-de-backend">Problemas de Backend</h2>
<h3 id="erro-de-migracao">Erro de migração</h3>
<pre><code class="language-bash"># Verificar status das migrações
python manage.py showmigrations

# Aplicar migrações pendentes
python manage.py migrate

# Resetar migrações (cuidado!)
python manage.py migrate --fake-initial
</code></pre>
<h3 id="erro-de-banco-de-dados">Erro de banco de dados</h3>
<pre><code class="language-bash"># Verificar conexão
python manage.py dbshell

# Testar conexão
python manage.py shell
&gt;&gt;&gt; from django.db import connection
&gt;&gt;&gt; connection.ensure_connection()
</code></pre>
<h3 id="erro-de-redis">Erro de Redis</h3>
<pre><code class="language-bash"># Verificar status
redis-cli ping

# Verificar logs
sudo journalctl -u redis-server
</code></pre>
<h3 id="erro-de-celery">Erro de Celery</h3>
<pre><code class="language-bash"># Verificar status
celery -A niochat inspect active

# Verificar workers
celery -A niochat inspect stats

# Reiniciar worker
sudo systemctl restart niochat-celery
</code></pre>
<h2 id="problemas-de-frontend">Problemas de Frontend</h2>
<h3 id="erro-de-build">Erro de build</h3>
<pre><code class="language-bash"># Limpar cache
npm cache clean --force

# Remover node_modules
rm -rf node_modules package-lock.json

# Reinstalar
npm install

# Build
npm run build
</code></pre>
<h3 id="erro-de-dependencias">Erro de dependências</h3>
<pre><code class="language-bash"># Verificar versão do Node
node --version

# Atualizar npm
npm install -g npm@latest

# Verificar dependências
npm audit
npm audit fix
</code></pre>
<h2 id="problemas-de-api">Problemas de API</h2>
<h3 id="erro-500">Erro 500</h3>
<pre><code class="language-bash"># Verificar logs
tail -f logs/django.log

# Verificar settings
python manage.py check

# Verificar banco
python manage.py dbshell
</code></pre>
<h3 id="erro-404">Erro 404</h3>
<pre><code class="language-bash"># Verificar URLs
python manage.py show_urls

# Verificar rotas
python manage.py shell
&gt;&gt;&gt; from django.urls import reverse
&gt;&gt;&gt; reverse('api:conversations-list')
</code></pre>
<h3 id="erro-de-autenticacao">Erro de autenticação</h3>
<pre><code class="language-bash"># Verificar tokens
python manage.py shell
&gt;&gt;&gt; from rest_framework.authtoken.models import Token
&gt;&gt;&gt; Token.objects.all()

# Criar token
python manage.py shell
&gt;&gt;&gt; from django.contrib.auth.models import User
&gt;&gt;&gt; from rest_framework.authtoken.models import Token
&gt;&gt;&gt; user = User.objects.get(username='admin')
&gt;&gt;&gt; token = Token.objects.create(user=user)
&gt;&gt;&gt; print(token.key)
</code></pre>
<h2 id="problemas-de-websocket">Problemas de WebSocket</h2>
<h3 id="conexao-falha">Conexão falha</h3>
<pre><code class="language-javascript">// Verificar URL
const ws = new WebSocket('ws://localhost:8010/ws/dashboard/');

// Verificar autenticação
const ws = new WebSocket('ws://localhost:8010/ws/dashboard/?token=seu_token');

// Verificar logs
tail -f logs/django.log
</code></pre>
<h3 id="mensagens-nao-chegam">Mensagens não chegam</h3>
<pre><code class="language-bash"># Verificar status do WebSocket
python manage.py shell
&gt;&gt;&gt; from channels.layers import get_channel_layer
&gt;&gt;&gt; channel_layer = get_channel_layer()
&gt;&gt;&gt; channel_layer.send('test', {'type': 'test'})
</code></pre>
<h2 id="problemas-de-integracao">Problemas de Integração</h2>
<h3 id="uazapi-nao-conecta">Uazapi não conecta</h3>
<pre><code class="language-bash"># Verificar URL
curl -I https://seu-provedor.uazapi.com

# Verificar token
curl -H &quot;Authorization: Bearer seu_token&quot; https://seu-provedor.uazapi.com/api/status
</code></pre>
<h3 id="openai-nao-responde">OpenAI não responde</h3>
<pre><code class="language-bash"># Verificar API key
python manage.py shell
&gt;&gt;&gt; from core.openai_service import openai_service
&gt;&gt;&gt; openai_service.test_connection()
</code></pre>
<h3 id="supabase-nao-conecta">Supabase não conecta</h3>
<pre><code class="language-bash"># Verificar configuração
python manage.py shell
&gt;&gt;&gt; from core.supabase_service import supabase_service
&gt;&gt;&gt; supabase_service.test_connection()
</code></pre>
<h2 id="problemas-de-performance">Problemas de Performance</h2>
<h3 id="lento">Lento</h3>
<pre><code class="language-bash"># Verificar CPU
top

# Verificar memória
free -h

# Verificar disco
df -h

# Verificar processos
ps aux | grep python
</code></pre>
<h3 id="alto-uso-de-memoria">Alto uso de memória</h3>
<pre><code class="language-bash"># Verificar Redis
redis-cli info memory

# Verificar PostgreSQL
sudo -u postgres psql -c &quot;SELECT * FROM pg_stat_activity;&quot;

# Verificar Celery
celery -A niochat inspect stats
</code></pre>
<h2 id="problemas-de-logs">Problemas de Logs</h2>
<h3 id="logs-nao-aparecem">Logs não aparecem</h3>
<pre><code class="language-bash"># Verificar configuração
python manage.py shell
&gt;&gt;&gt; import logging
&gt;&gt;&gt; logger = logging.getLogger('django')
&gt;&gt;&gt; logger.info('Teste')

# Verificar arquivo de log
ls -la logs/
tail -f logs/django.log
</code></pre>
<h3 id="logs-muito-grandes">Logs muito grandes</h3>
<pre><code class="language-bash"># Rotacionar logs
sudo logrotate -f /etc/logrotate.d/django

# Limpar logs antigos
find logs/ -name &quot;*.log&quot; -mtime +7 -delete
</code></pre>
<h2 id="problemas-de-seguranca">Problemas de Segurança</h2>
<h3 id="erro-de-csrf">Erro de CSRF</h3>
<pre><code class="language-bash"># Verificar configuração
python manage.py shell
&gt;&gt;&gt; from django.conf import settings
&gt;&gt;&gt; settings.CSRF_TRUSTED_ORIGINS
</code></pre>
<h3 id="erro-de-cors">Erro de CORS</h3>
<pre><code class="language-bash"># Verificar configuração
python manage.py shell
&gt;&gt;&gt; from django.conf import settings
&gt;&gt;&gt; settings.CORS_ALLOWED_ORIGINS
</code></pre>
<h2 id="problemas-de-deploy">Problemas de Deploy</h2>
<h3 id="build-falha">Build falha</h3>
<pre><code class="language-bash"># Verificar dependências
pip check

# Verificar requirements
pip install -r requirements.txt

# Verificar Python
python --version
</code></pre>
<h3 id="deploy-nao-funciona">Deploy não funciona</h3>
<pre><code class="language-bash"># Verificar permissões
ls -la /opt/niochat/

# Verificar serviços
sudo systemctl status niochat-backend
sudo systemctl status niochat-celery
</code></pre>
<h2 id="comandos-uteis">Comandos Úteis</h2>
<h3 id="verificar-status">Verificar status</h3>
<pre><code class="language-bash"># Serviços
sudo systemctl status niochat-backend
sudo systemctl status niochat-celery
sudo systemctl status niochat-celery-beat

# Banco de dados
sudo -u postgres psql -d niochat -c &quot;SELECT version();&quot;

# Redis
redis-cli ping

# Nginx
sudo nginx -t
</code></pre>
<h3 id="limpar-cache">Limpar cache</h3>
<pre><code class="language-bash"># Django
python manage.py clear_cache

# Redis
redis-cli flushall

# Nginx
sudo nginx -s reload
</code></pre>
<h3 id="reiniciar-servicos">Reiniciar serviços</h3>
<pre><code class="language-bash"># Todos os serviços
sudo systemctl restart niochat-backend
sudo systemctl restart niochat-celery
sudo systemctl restart niochat-celery-beat

# Nginx
sudo systemctl restart nginx

# PostgreSQL
sudo systemctl restart postgresql

# Redis
sudo systemctl restart redis-server
</code></pre>
<h2 id="logs-importantes">Logs Importantes</h2>
<h3 id="django">Django</h3>
<pre><code class="language-bash">tail -f logs/django.log
</code></pre>
<h3 id="celery">Celery</h3>
<pre><code class="language-bash">tail -f logs/celery.log
</code></pre>
<h3 id="nginx">Nginx</h3>
<pre><code class="language-bash">tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
</code></pre>
<h3 id="sistema">Sistema</h3>
<pre><code class="language-bash">journalctl -u niochat-backend -f
journalctl -u niochat-celery -f
</code></pre>
<h2 id="contato">Contato</h2>
<p>Se você não conseguir resolver o problema:</p>
<ol>
<li><strong>GitHub Issues</strong>: <a href="https://github.com/juniorssilvaa/niochat/issues">Reportar problema</a></li>
<li><strong>Email</strong>: suporte@niochat.com.br</li>
<li><strong>Documentação</strong>: Navegue pelas seções da documentação</li>
</ol>
<h2 id="proximos-passos">Próximos Passos</h2>
<ol>
<li><a href="installation/development.md">Instalação</a> - Configure o ambiente</li>
<li><a href="configuration/supabase.md">Configuração</a> - Configure integrações</li>
<li><a href="usage/interface.md">Uso</a> - Aprenda a usar o sistema</li>
<li><a href="api/endpoints.md">API</a> - Explore a API</li>
</ol></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
